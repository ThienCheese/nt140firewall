<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H∆∞·ªõng d·∫´n K·∫øt n·ªëi Firewall</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #f0f2f5;
            color: #333;
            margin: 0;
            padding: 1rem;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        main {
            max-width: 800px;
            width: 100%;
            margin: 2rem 0;
            background-color: #ffffff;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            overflow: hidden;
        }
        header {
            background-color: #2c3e50;
            color: #ecf0f1;
            padding: 2rem;
            text-align: center;
        }
        header h1 {
            margin: 0;
            font-size: 2rem;
        }
        header p {
            margin: 0.5rem 0 0;
            font-size: 1.1rem;
            opacity: 0.9;
        }
        .content {
            padding: 2rem;
        }
        h2 {
            color: #2c3e50;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 0.5rem;
            margin-top: 2rem;
        }
        .device-section {
            display: flex;
            flex-wrap: wrap;
            gap: 2rem;
            margin-top: 1.5rem;
        }
        .device {
            flex: 1;
            min-width: 250px;
            background: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .device h3 {
            margin-top: 0;
            color: #34495e;
        }
        .qr-code {
            text-align: center;
            margin: 1rem 0;
        }
        .qr-code img {
            border: 5px solid #fff;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        code, .hostname {
            background: #eee;
            padding: 3px 6px;
            border-radius: 4px;
            font-family: "Courier New", Courier, monospace;
            font-weight: bold;
            color: #c0392b;
            display: inline-block;
            word-break: break-all;
        }
        ol {
            padding-left: 1.5rem;
            line-height: 1.6;
        }
        summary {
            font-weight: bold;
            font-size: 1.1rem;
            cursor: pointer;
            padding: 0.5rem 0;
            color: #2980b9;
        }
        details {
            margin-top: 1rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 0 1rem;
        }
        details[open] {
            padding-bottom: 1rem;
        }
        .footer {
            text-align: center;
            padding: 1.5rem;
            font-size: 0.9rem;
            color: #777;
            background-color: #f9f9f9;
            border-top: 1px solid #eee;
        }
    </style>
</head>
<body>
    <main>
        <header>
            <h1>üõ°Ô∏è DNS Firewall - H∆∞·ªõng d·∫´n K·∫øt n·ªëi</h1>
            <p>Ch·∫∑n qu·∫£ng c√°o v√† b·∫£o v·ªá quy·ªÅn ri√™ng t∆∞ cho to√†n b·ªô thi·∫øt b·ªã</p>
        </header>

        <div class="content">
            <!-- T√™n mi·ªÅn c·ªßa b·∫°n (ƒë·ªÉ tham kh·∫£o) -->
            <p style="text-align: center; background: #e8f4f8; padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                <strong>üåê T√™n mi·ªÅn Firewall:</strong> <span class="hostname">thiencheese.me</span><br>
                <small style="color: #666;">‚úÖ ƒê√£ tri·ªÉn khai v·ªõi Cloudflare Tunnel | ‚úÖ H·ªó tr·ª£ DoH/DoT</small>
            </p>

            <h2>üì± Thi·∫øt b·ªã Di ƒë·ªông (Nhanh nh·∫•t - Khuy√™n d√πng)</h2>
            <div class="device-section">
                <!-- H∆∞·ªõng d·∫´n cho Android -->
                <div class="device">
                    <h3>ü§ñ Android (9+)</h3>
                    <p><strong>‚úÖ Ph∆∞∆°ng ph√°p t·ªët nh·∫•t:</strong> C·∫•u h√¨nh Private DNS v·ªõi DoT (DNS-over-TLS)</p>
                    <div class="qr-code">
                        <img src="https://api.qrserver.com/v1/create-qr-code/?size=180x180&data=thiencheese.me" alt="QR Code for Android">
                    </div>
                    <ol>
                        <li>Qu√©t m√£ QR b·∫±ng Camera ho·∫∑c Google Lens.</li>
                        <li>Sao ch√©p (Copy) text: <code>thiencheese.me</code></li>
                        <li>V√†o <strong>C√†i ƒë·∫∑t</strong> ‚Üí <strong>K·∫øt n·ªëi</strong> ‚Üí <strong>DNS ri√™ng t∆∞</strong></li>
                        <li>Ch·ªçn <strong>"T√™n m√°y ch·ªß c·ªßa nh√† cung c·∫•p DNS ri√™ng t∆∞"</strong></li>
                        <li>D√°n <code>thiencheese.me</code> v√† nh·∫•n <strong>L∆∞u</strong></li>
                    </ol>
                    <p style="background: #d4edda; padding: 0.5rem; border-radius: 4px; font-size: 0.9rem;">
                        ‚úÖ <strong>∆Øu ƒëi·ªÉm:</strong> M√£ h√≥a to√†n b·ªô DNS, ho·∫°t ƒë·ªông d√π ·ªü nh√† hay ra ngo√†i (4G/5G/WiFi c√¥ng c·ªông)
                    </p>
                </div>

                <!-- H∆∞·ªõng d·∫´n cho iOS / macOS -->
                <div class="device">
                    <h3>üçé iOS & macOS</h3>
                    <p><strong>C√°ch 1:</strong> D√πng app h·ªó tr·ª£ DoH (DNSCloak, 1.1.1.1)</p>
                    <ol>
                        <li>T·∫£i app <strong>DNSCloak</strong> (mi·ªÖn ph√≠) t·ª´ App Store</li>
                        <li>M·ªü app ‚Üí <strong>DNS Servers</strong> ‚Üí <strong>Add Server</strong></li>
                        <li>Ch·ªçn <strong>DNS-over-HTTPS</strong></li>
                        <li>Nh·∫≠p URL: <code>https://thiencheese.me/dns-query</code></li>
                        <li>Nh·∫•n <strong>Save</strong> v√† k√≠ch ho·∫°t</li>
                    </ol>
                    
                    <p><strong>C√°ch 2:</strong> T·∫£i profile c·∫•u h√¨nh (y√™u c·∫ßu file .mobileconfig)</p>
                    <div class="qr-code">
                        <img src="https://api.qrserver.com/v1/create-qr-code/?size=180x180&data=https://thiencheese.me/clients/apple_ios_mac/DoH.mobileconfig" alt="QR Code for iOS/macOS">
                    </div>
                    <ol>
                        <li>Qu√©t m√£ QR ƒë·ªÉ t·∫£i profile (n·∫øu ƒë√£ t·∫°o file .mobileconfig)</li>
                        <li>V√†o <strong>Settings</strong> ‚Üí <strong>Profile Downloaded</strong></li>
                        <li>Nh·∫•n <strong>Install</strong> v√† x√°c nh·∫≠n</li>
                    </ol>
                    <p style="background: #fff3cd; padding: 0.5rem; border-radius: 4px; font-size: 0.9rem;">
                        ‚ö†Ô∏è <strong>L∆∞u √Ω:</strong> iOS kh√¥ng h·ªó tr·ª£ DoT native, c·∫ßn d√πng app ho·∫∑c profile
                    </p>
                </div>
            </div>

            <h2>üíª M√°y t√≠nh (Desktop/Laptop)</h2>
            <p style="background: #e3f2fd; padding: 0.8rem; border-radius: 6px; margin-bottom: 1rem;">
                <strong>üí° G·ª£i √Ω:</strong> N·∫øu m√°y t√≠nh <strong>ch·ªâ d√πng t·∫°i nh√†</strong>, c·∫•u h√¨nh DNS LAN (192.168.1.100) ƒë·ªÉ c√≥ t·ªëc ƒë·ªô nhanh nh·∫•t. 
                N·∫øu <strong>th∆∞·ªùng xuy√™n mang ra ngo√†i</strong> (laptop), d√πng DoH ƒë·ªÉ ƒë∆∞·ª£c b·∫£o v·ªá ·ªü m·ªçi n∆°i.
            </p>
            
            <!-- H∆∞·ªõng d·∫´n cho Windows -->
            <details>
                <summary>ü™ü Windows (10 & 11)</summary>
                
                <h4>C√°ch 1: DNS LAN (Ch·ªâ ho·∫°t ƒë·ªông t·∫°i nh√† - Nhanh nh·∫•t ‚ö°)</h4>
                <ol>
                    <li>M·ªü <strong>Settings</strong> ‚Üí <strong>Network & Internet</strong></li>
                    <li>Nh·∫•p v√†o <strong>Wi-Fi</strong> (ho·∫∑c <strong>Ethernet</strong>)</li>
                    <li>Nh·∫•p v√†o <strong>Hardware properties</strong></li>
                    <li>T√¨m <strong>"DNS server assignment"</strong> v√† nh·∫•p <strong>Edit</strong></li>
                    <li>Ch·ªçn <strong>"Manual"</strong> v√† b·∫≠t <strong>IPv4</strong></li>
                    <li>Trong √¥ <strong>"Preferred DNS"</strong>, nh·∫≠p: <code>192.168.1.100</code></li>
                    <li>ƒê·ªÉ tr·ªëng <strong>"Alternate DNS"</strong> ho·∫∑c nh·∫≠p: <code>1.1.1.1</code> (backup)</li>
                    <li>Nh·∫•n <strong>Save</strong></li>
                </ol>
                <p style="background: #d4edda; padding: 0.5rem; border-radius: 4px; font-size: 0.9rem;">
                    ‚úÖ <strong>Latency:</strong> ~2-5ms | <strong>Encryption:</strong> None (LAN) | <strong>Coverage:</strong> Home only
                </p>

                <h4>C√°ch 2: DNS-over-HTTPS (Ho·∫°t ƒë·ªông m·ªçi n∆°i - Laptop üîí)</h4>
                <p><strong>Windows 11 only:</strong></p>
                <ol>
                    <li>M·ªü <strong>Settings</strong> ‚Üí <strong>Network & Internet</strong> ‚Üí <strong>Ethernet/Wi-Fi</strong></li>
                    <li>Click <strong>Hardware properties</strong></li>
                    <li>B·∫≠t <strong>"Use secure DNS (DNS over HTTPS)"</strong></li>
                    <li>Ch·ªçn <strong>"Manual"</strong></li>
                    <li>Nh·∫≠p: <code>https://thiencheese.me/dns-query</code></li>
                    <li>Nh·∫•n <strong>Save</strong></li>
                </ol>
                
                <p><strong>Ho·∫∑c d√πng Browser (Chrome/Firefox):</strong></p>
                <ul>
                    <li><strong>Chrome:</strong> Settings ‚Üí Security ‚Üí Use secure DNS ‚Üí Custom ‚Üí <code>https://thiencheese.me/dns-query</code></li>
                    <li><strong>Firefox:</strong> Settings ‚Üí Network Settings ‚Üí Enable DNS over HTTPS ‚Üí Custom ‚Üí <code>https://thiencheese.me/dns-query</code></li>
                </ul>
                <p style="background: #d4edda; padding: 0.5rem; border-radius: 4px; font-size: 0.9rem;">
                    ‚úÖ <strong>Latency:</strong> ~50-100ms | <strong>Encryption:</strong> TLS 1.3 | <strong>Coverage:</strong> Global
                </p>

                <h4>C√°ch 3: Script t·ª± ƒë·ªông (Ch·ªâ LAN)</h4>
                <p>T·∫£i v√† ch·∫°y script PowerShell (Run as Administrator):</p>
                <ul>
                    <li><a href="/clients/windows/connect.ps1" download>üì• connect.ps1</a> - C·∫•u h√¨nh DNS LAN t·ª± ƒë·ªông</li>
                    <li><a href="/clients/windows/disconnect.ps1" download>üì• disconnect.ps1</a> - Kh√¥i ph·ª•c DNS m·∫∑c ƒë·ªãnh</li>
                </ul>
            </details>

            <!-- H∆∞·ªõng d·∫´n cho Linux -->
            <details>
                <summary>üêß Linux (Ubuntu/Debian/Fedora)</summary>
                
                <h4>C√°ch 1: GUI (GNOME/KDE) - DNS LAN</h4>
                <ol>
                    <li>M·ªü <strong>Settings</strong> ‚Üí <strong>Network</strong></li>
                    <li>Nh·∫•p v√†o bi·ªÉu t∆∞·ª£ng ‚öôÔ∏è b√™n c·∫°nh k·∫øt n·ªëi hi·ªán t·∫°i</li>
                    <li>Chuy·ªÉn sang tab <strong>"IPv4"</strong></li>
                    <li>T·∫Øt <strong>"Automatic"</strong> cho DNS</li>
                    <li>Nh·∫≠p DNS Servers: <code>192.168.1.100</code></li>
                    <li>(T√πy ch·ªçn) T·∫Øt <strong>IPv6</strong> ƒë·ªÉ tr√°nh DNS leak</li>
                    <li>Nh·∫•n <strong>Apply</strong></li>
                    <li>Restart network: <code>sudo systemctl restart NetworkManager</code></li>
                </ol>

                <h4>C√°ch 2: systemd-resolved (DNS-over-TLS)</h4>
                <pre style="background: #2d2d2d; color: #f8f8f2; padding: 1rem; border-radius: 6px; overflow-x: auto;">
<code># Edit /etc/systemd/resolved.conf
sudo nano /etc/systemd/resolved.conf

# Add these lines:
[Resolve]
DNS=1.1.1.1
DNSOverTLS=yes
Domains=~.

# Restart service
sudo systemctl restart systemd-resolved

# Verify
resolvectl status</code></pre>
                <p style="background: #fff3cd; padding: 0.5rem; border-radius: 4px; font-size: 0.9rem;">
                    ‚ö†Ô∏è <strong>L∆∞u √Ω:</strong> systemd-resolved kh√¥ng h·ªó tr·ª£ custom DoT hostname, c·∫ßn d√πng <code>stubby</code> ho·∫∑c <code>dnscrypt-proxy</code>
                </p>

                <h4>C√°ch 3: Command line (nhanh)</h4>
                <pre style="background: #2d2d2d; color: #f8f8f2; padding: 1rem; border-radius: 6px; overflow-x: auto;">
<code># Set DNS for current connection (temporary)
nmcli connection modify "Wi-Fi" ipv4.dns "192.168.1.100"
nmcli connection down "Wi-Fi" && nmcli connection up "Wi-Fi"

# Verify
nslookup google.com</code></pre>
            </details>

            <!-- H∆∞·ªõng d·∫´n cho macOS -->
            <details>
                <summary>üçé macOS</summary>
                
                <h4>C√°ch 1: System Preferences - DNS LAN</h4>
                <ol>
                    <li>M·ªü <strong>System Preferences</strong> ‚Üí <strong>Network</strong></li>
                    <li>Ch·ªçn k·∫øt n·ªëi hi·ªán t·∫°i (Wi-Fi/Ethernet)</li>
                    <li>Nh·∫•n <strong>Advanced...</strong></li>
                    <li>Chuy·ªÉn sang tab <strong>DNS</strong></li>
                    <li>Nh·∫•n <strong>+</strong> v√† th√™m: <code>192.168.1.100</code></li>
                    <li>Nh·∫•n <strong>OK</strong> v√† <strong>Apply</strong></li>
                </ol>

                <h4>C√°ch 2: Terminal (nhanh)</h4>
                <pre style="background: #2d2d2d; color: #f8f8f2; padding: 1rem; border-radius: 6px; overflow-x: auto;">
<code># Get network service name
networksetup -listallnetworkservices

# Set DNS (replace "Wi-Fi" with your service name)
sudo networksetup -setdnsservers Wi-Fi 192.168.1.100

# Verify
scutil --dns</code></pre>

                <h4>C√°ch 3: DNS Profile (DoH/DoT)</h4>
                <p>C√†i ƒë·∫∑t app <strong>DNSCloak</strong> ho·∫∑c t·∫°o Configuration Profile (.mobileconfig) v·ªõi DoH endpoint:</p>
                <code>https://thiencheese.me/dns-query</code>
            </details>
        </div>

            <h2>üß™ Ki·ªÉm tra K·∫øt n·ªëi</h2>
            <div style="background: #f8f9fa; padding: 1.5rem; border-radius: 8px; border-left: 4px solid #28a745;">
                <h3 style="margin-top: 0;">Sau khi c·∫•u h√¨nh xong:</h3>
                
                <h4>1Ô∏è‚É£ Ki·ªÉm tra DNS ƒëang d√πng</h4>
                <ul>
                    <li><strong>Windows:</strong> M·ªü CMD, g√µ: <code>nslookup google.com</code></li>
                    <li><strong>Linux/Mac:</strong> M·ªü Terminal, g√µ: <code>dig google.com</code></li>
                    <li>Xem d√≤ng <strong>"Server:"</strong> ph·∫£i l√† <code>192.168.1.100</code> (LAN) ho·∫∑c <code>thiencheese.me</code> (WAN)</li>
                </ul>

                <h4>2Ô∏è‚É£ Test ch·∫∑n qu·∫£ng c√°o</h4>
                <ul>
                    <li>Th·ª≠ truy v·∫•n domain qu·∫£ng c√°o: <code>nslookup ads.google.com</code></li>
                    <li>Ph·∫£i tr·∫£ v·ªÅ IP <code>127.0.0.1</code> (b·ªã ch·∫∑n) ‚úÖ</li>
                </ul>

                <h4>3Ô∏è‚É£ Test DoH Endpoint (t·ª´ browser)</h4>
                <ul>
                    <li>M·ªü link: <a href="https://thiencheese.me/dns-query?name=google.com&type=A" target="_blank">https://thiencheese.me/dns-query?name=google.com&type=A</a></li>
                    <li>Ph·∫£i th·∫•y JSON response v·ªõi IP c·ªßa Google ‚úÖ</li>
                </ul>

                <h4>4Ô∏è‚É£ Truy c·∫≠p Dashboard</h4>
                <ul>
                    <li>URL: <a href="https://thiencheese.me" target="_blank" style="font-weight: bold; color: #2980b9;">https://thiencheese.me</a></li>
                    <li>Username: <code>admin</code></li>
                    <li>Password: (Xem trong file .env c·ªßa b·∫°n)</li>
                    <li>Xem th·ªëng k√™: T·ªïng queries, Blocked queries, Query logs</li>
                </ul>
            </div>

            <h2>üìö T√†i nguy√™n h·ªØu √≠ch</h2>
            <div style="background: #fff3cd; padding: 1.5rem; border-radius: 8px;">
                <ul style="margin: 0;">
                    <li>üìñ <a href="https://github.com/ThienCheese/test/blob/main/README.md" target="_blank">README.md</a> - H∆∞·ªõng d·∫´n tri·ªÉn khai ƒë·∫ßy ƒë·ªß</li>
                    <li>üèóÔ∏è <a href="https://github.com/ThienCheese/test/blob/main/docs/ARCHITECTURE.md" target="_blank">ARCHITECTURE.md</a> - Ki·∫øn tr√∫c h·ªá th·ªëng chi ti·∫øt</li>
                    <li>üìä <a href="https://github.com/ThienCheese/test/blob/main/docs/REPORT.md" target="_blank">REPORT.md</a> - B√°o c√°o khoa h·ªçc</li>
                    <li>üõ†Ô∏è <a href="https://github.com/ThienCheese/test" target="_blank">GitHub Repository</a> - Source code</li>
                </ul>
            </div>

            <h2>‚ùì G·∫∑p v·∫•n ƒë·ªÅ?</h2>
            <div style="background: #f8d7da; padding: 1.5rem; border-radius: 8px; border-left: 4px solid #dc3545;">
                <h4 style="margin-top: 0;">C√°c v·∫•n ƒë·ªÅ th∆∞·ªùng g·∫∑p:</h4>
                
                <details style="margin-top: 1rem;">
                    <summary style="cursor: pointer; font-weight: bold;">‚ùå Kh√¥ng k·∫øt n·ªëi ƒë∆∞·ª£c DNS</summary>
                    <ul>
                        <li>Ki·ªÉm tra Docker containers c√≥ ch·∫°y kh√¥ng: <code>docker compose ps</code></li>
                        <li>Xem logs: <code>docker compose logs -f</code></li>
                        <li>Restart: <code>docker compose restart</code></li>
                    </ul>
                </details>

                <details style="margin-top: 1rem;">
                    <summary style="cursor: pointer; font-weight: bold;">‚ùå DoT/DoH kh√¥ng ho·∫°t ƒë·ªông t·ª´ WAN</summary>
                    <ul>
                        <li>Ki·ªÉm tra Cloudflare Tunnel status: V√†o Zero Trust Dashboard</li>
                        <li>Xem logs cloudflared: <code>docker compose logs cloudflared</code></li>
                        <li>Verify Public Hostnames ƒë√£ c·∫•u h√¨nh ƒë√∫ng (HTTP + TCP)</li>
                    </ul>
                </details>

                <details style="margin-top: 1rem;">
                    <summary style="cursor: pointer; font-weight: bold;">‚ùå Dashboard y√™u c·∫ßu login nh∆∞ng kh√¥ng v√†o ƒë∆∞·ª£c</summary>
                    <ul>
                        <li>Username lu√¥n l√†: <code>admin</code></li>
                        <li>Password: Ki·ªÉm tra <code>ADMIN_PASSWORD</code> trong file <code>.env</code></li>
                        <li>N·∫øu qu√™n password: T·∫°o hash m·ªõi v·ªõi: <code>docker run --rm caddy:latest caddy hash-password</code></li>
                    </ul>
                </details>

                <details style="margin-top: 1rem;">
                    <summary style="cursor: pointer; font-weight: bold;">‚ùå Kh√¥ng ch·∫∑n ƒë∆∞·ª£c qu·∫£ng c√°o</summary>
                    <ul>
                        <li>Ki·ªÉm tra blacklist ƒë√£ t·∫£i: <code>docker compose exec dns_server ls -lh /app/data/blacklist.txt</code></li>
                        <li>Force update blacklist: V√†o Dashboard ‚Üí Reload Blacklist</li>
                        <li>Xem logs query: Dashboard ‚Üí Query Logs ‚Üí Xem domain c√≥ b·ªã ch·∫∑n kh√¥ng</li>
                    </ul>
                </details>

                <p style="margin-top: 1rem; margin-bottom: 0;">
                    <strong>V·∫´n c·∫ßn help?</strong> M·ªü issue tr√™n <a href="https://github.com/ThienCheese/test/issues" target="_blank">GitHub</a>
                </p>
            </div>
        </div>

        <div class="footer">
            <p style="margin: 0;">
                <strong>üõ°Ô∏è DNS Firewall</strong> - Powered by Docker + Caddy + Python + Cloudflare<br>
                <small>üìç Domain: <a href="https://thiencheese.me">thiencheese.me</a> | 
                üìä Dashboard: <a href="https://thiencheese.me">https://thiencheese.me</a> | 
                üîí Encrypted with TLS 1.3</small>
            </p>
        </div>
    </main>
</body>
</html>